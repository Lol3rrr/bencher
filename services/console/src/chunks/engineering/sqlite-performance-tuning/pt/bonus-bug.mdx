import BonusBugSql from "../bonus-bug-sql.mdx";
import BonusBugSqlIssue from "../bonus-bug-sql-issue.mdx";
import BonusBugSqlFix from "../bonus-bug-sql-fix.mdx";
import BonusBugRustSchema from "../bonus-bug-rust-schema.mdx";
import BonusBugRustLeftJoin from "../bonus-bug-rust-left-join.mdx";

## B√¥nus Bug

Eu originalmente encontrei um bug no meu c√≥digo de [vis√£o materializada][vis√£o materializada].
A consulta SQL parecia com isso:

<BonusBugSql />

Voc√™ v√™ o problema? N√£o. Eu tamb√©m n√£o!

O problema est√° justamente aqui:

<BonusBugSqlIssue />

Na verdade, deveria ser:

<BonusBugSqlFix />

Eu estava tentando ser muito esperto,
e na minha estrutura de vis√£o materializada Diesel eu permiti essa jun√ß√£o:

<BonusBugRustSchema />

Eu assumi que essa macro era de alguma forma inteligente o suficiente
para relacionar o `alert.boundary_id` ao `metric_boundary.boundary_id`.
Mas, infelizmente, n√£o era.
Parece que ela apenas escolheu a primeira coluna de `metric_boundary` (`metric_id`) para relacionar com `alert`.

Uma vez que descobri o bug, foi f√°cil de corrigir.
Eu s√≥ tive que usar uma jun√ß√£o expl√≠cita na consulta Perf:

<BonusBugRustLeftJoin />

<br />

> üê∞ Isso √© tudo, pessoal!

[vis√£o materializada]: #vis√£o-materializada